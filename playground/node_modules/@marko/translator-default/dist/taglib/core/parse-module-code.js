"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule = true;exports.default = _default;var _modules = _interopRequireDefault(require("@marko/compiler/modules"));
var _path = _interopRequireDefault(require("path"));
var _resolveFrom = _interopRequireDefault(require("resolve-from"));

const startOffset = "module-code".length;

function _default(tag) {
  const {
    hub: { file },
    node: { rawValue }
  } = tag;
  const dirname = _path.default.dirname(file.opts.filename);
  const relativeRequire = (entry) =>
  _modules.default.require((0, _resolveFrom.default)(dirname, entry));
  const fn = eval(rawValue.slice(startOffset));
  const source = fn(relativeRequire, file.markoOpts);
  file.metadata.marko.moduleCode = source;
}